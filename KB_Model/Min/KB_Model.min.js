var CreateKB_Model=function(){function f(){function e(){for(var d=Object.keys(q),a=0,c={},b,r,a=0;a<d.length;a++)c=q[d[a]],b=t("local").getItem("KB_Model_"+d[a]),r=t("session").getItem("KB_Model_"+d[a]),b?c._getData=JSON.parse(b):r?c._getData=JSON.parse(r):(c._getData=e.deepCopy(c._tempData),c._save&&t(c._save).setItem("KB_Model_"+d[a],JSON.stringify(c._getData))),e.deepInject(c._getData,c._bindData,d[a]),c._model&&(f[d[a]]={},e.deepInject(c._getData,f[d[a]],"Model"))}var f={},q={},m={},g={},w=function(d){return Array.prototype.concat.apply([],
d.split(".").map(function(a,c){return a.split("[").map(function(a,c){return-1<a.indexOf("]")?"["+a:a})}))},y=function(d,a,c,b,e,g,m,q,z){this.stopPropagation=function(){this._stopPropogation=!0};this.preventDefault=function(){this._preventDefault=!0};this.viewModel=d;this.viewModelKey=a;this.scope=c;this.value=b;this.oldValue=e;this.scopeString=g;this.key=m;this.args=q;this.action=z},v=["local","session"],t=function(d){if(-1<v.indexOf(d))return"local"===d?localStorage:sessionStorage};e.Model=function(){return f};
e.ViewModel=function(d,a,c,b){if(void 0===a&&void 0===d)return q;if(void 0===a&&void 0!==d)return q[d]._bindData;q[d]={_tempData:a,_getData:{},_bindData:{},_save:void 0===c?!1:c,_model:!(void 0!==b&&!b)};return e};e.deepCopy=function(d,a){var c=Object.keys(d),b="",g=0;a=void 0===a?d.constructor.toString()===Object.toString()?{}:[]:a;for(g=0;g<c.length;g++)b=d[c[g]],b.constructor.toString()===Object.toString()?(a[c[g]]={},e.deepCopy(b,a[c[g]])):b.constructor.toString()===Array.toString()?(a[c[g]]=
[],e.deepCopy(b,a[c[g]])):a[c[g]]=b;return a};e.deepInject=function(d,a,c,b){b=void 0===b?"":b;c=void 0===c?"unknown":c;a=void 0===a?d.constructor.toString()===Object.toString()?{}:[]:a;var f=Object.keys(d),x,n;a=void 0===a?{}:a;var v=function(b,f,p){var n=f.constructor.toString()===Object.toString(),r=f.constructor.toString()===Array.toString();p=1>p.length&&f.constructor.toString()===Array.toString()?p+(b+"["):1>p.length?p+b:p.lastIndexOf("[")===p.length-1?p+(b+"]"+(f.constructor.toString()===Array.toString()?
"[":"")):f.constructor.toString()===Array.toString()?p+("."+b+"["):p+("."+b);n||r?(Object.defineProperty(a,b,{value:n?{}:[],writable:!1,enumerable:!0,configurable:!0}),e.deepInject(d[b],a[b],c,p)):Object.defineProperty(a,b,{get:function(){return d[b]},set:function(e){var h=d[b],f;f=p;var l=new y(q[c],c,a,e,h,f,b),k=0,n=0,u=w(f),r="";if(void 0!==m["*"])b:for(k=0;k<m["*"].length;k++)if(m["*"][k].call({},l),l._stopPropogation)break b;if(void 0!==m[b]&&!l._stopPropogation)b:for(k=0;k<m[b].length;k++)if(m[b][k].call({},
l),l._stopPropogation)break b;if(!l._stopPropogation)b:for(n=0;n<u.length;n++)if(r=u.slice(0,n+1).join(".").replace(/(\.\[)/g,"["),void 0!==m[r]&&!l._stopPropogation)for(k=0;k<m[r].length;k++)if(m[r][k].call({},l),l._stopPropogation)break b;if(void 0!==m[f]&&!l._stopPropogation)b:for(k=0;k<m[f].length;k++)if(m[f][k].call({},l),l._stopPropogation)break b;f=l._preventDefault?!1:!0;f&&(d[b]=e);f=c;l=p;e=new y(q[f],f,a,e,h,l,b,void 0,void 0);k=h=0;n=w(l);u="";if(void 0!==g["*"])b:for(h=0;h<g["*"].length;h++)if(g["*"][h].call({},
e),e._stopPropogation)break b;if(void 0!==g[b])b:for(h=0;h<g[b].length;h++)if(g[b][h].call({},e),e._stopPropogation)break b;if(!e._stopPropogation)b:for(k=0;k<n.length;k++)if(u=n.slice(0,k+1).join(".").replace(/(\.\[)/g,"["),void 0!==g[u]&&!e._stopPropogation)for(h=0;h<g[u].length;h++)if(g[u][h].call({},e),e._stopPropogation)break b;if(void 0!==g[l]&&!e._stopPropogation)b:for(h=0;h<g[l].length;h++)if(g[l][h].call({},e),e._stopPropogation)break b;e=t("local").getItem("KB_Model_"+f);h=t("session").getItem("KB_Model_"+
f);e?t("local").setItem("KB_Model_"+f,JSON.stringify(q[f]._getData)):h&&t("session").setItem("KB_Model_"+f,JSON.stringify(q[f]._getData))},enumerable:!0,configurable:!0})};for(n=0;n<f.length;n++)x=d[f[n]],v(f[n],x,b);return a};e.addDataListener=function(d,a){void 0===m[d]&&(m[d]=[]);m[d].push(a);return e};e.removeDataListener=function(d,a){var c=0,b=dataListeners[d];if(void 0!==b)a:for(c=0;c<b.length;c++)if(b[c].toString()===a.toString()){b.splice(c,1);break a}return e};e.getDataListeners=function(){return m};
e.addDataUpdateListener=function(d,a){void 0===g[d]&&(g[d]=[]);g[d].push(a);return e};e.removeDataUpdateListener=function(d,a){var c=0,b=g[d];if(void 0!==b)a:for(c=0;c<b.length;c++)if(b[c].toString()===a.toString()){b.splice(c,1);break a}return e};e.getDataUpdateListeners=function(){return g};return e}"function"===typeof define&&define.amd?(define("KB_Model",f),define([],f)):"object"===typeof module&&module.exports&&(module.exports=f);return f}();
